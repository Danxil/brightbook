module.exports = function(sequelize, DataTypes) {
    return sequelize.define('LoginToken', {
        login: {
            type: DataTypes.STRING,
            unique: true
        },
        token: {
            type: DataTypes.STRING
        },
        series: {
            type: DataTypes.STRING
        }
    },
    {
        instanceMethods: {
            randomValue: function() {
                return Math.round((new Date().valueOf() * Math.random())) + '';
            },
            cookieValue: function() {
                return JSON.stringify({login: this.login, series: this.series, token: this.token});
            }
        },
        hooks: {
            beforeValidate: function (model, options, fn) {
                model.token = model.randomValue();
                model.series = model.randomValue();
            }
        }
    })
}